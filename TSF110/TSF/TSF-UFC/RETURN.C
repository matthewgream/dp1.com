
int output_conversion(l1,l2,r1,r2,salt)
  unsigned long l1,l2,r1,r2;
  char *salt;
  {
    register unsigned long v1,v2;

    l1 >>= 3;
    l2 >>= 3;
    r1 >>= 3;
    r2 >>= 3;

    v1 =  efp[ 3][ l1       & 0x3f][0] |
          efp[ 2][(l1>>6)   & 0x3f][0] |
          efp[ 1][(l1>>16)  & 0x3f][0] |
          efp[ 0][(l1>>22)  & 0x3f][0] |
          efp[ 7][ l2       & 0x3f][0] |
          efp[ 6][(l2>>6)   & 0x3f][0] |
          efp[ 5][(l2>>16)  & 0x3f][0] |
          efp[ 4][(l2>>22)  & 0x3f][0] |
          efp[11][ r1       & 0x3f][0] |
          efp[10][(r1>>6)   & 0x3f][0] |
          efp[ 9][(r1>>16)  & 0x3f][0] |
          efp[ 8][(r1>>22)  & 0x3f][0] |
          efp[15][ r2       & 0x3f][0] |
          efp[14][(r2>>6)   & 0x3f][0] |
          efp[13][(r2>>16)  & 0x3f][0] |
          efp[12][(r2>>22)  & 0x3f][0];
    
    if(    (salt[ 2]==((v1>>26) & 0x3f)) &&
           (salt[ 3]==((v1>>20) & 0x3f)) &&
           (salt[ 4]==((v1>>14) & 0x3f)) &&
           (salt[ 5]==((v1>> 8) & 0x3f)) &&
           (salt[ 6]==((v1>> 2) & 0x3f))
           ) {

                 v2 = efp[ 3][ l1       & 0x3f][1] |
                      efp[ 2][(l1>>6)   & 0x3f][1] |
                      efp[ 1][(l1>>16)  & 0x3f][1] |
                      efp[ 0][(l1>>22)  & 0x3f][1] |
                      efp[ 7][ l2       & 0x3f][1] |
                      efp[ 6][(l2>>6)   & 0x3f][1] |
                      efp[ 5][(l2>>16)  & 0x3f][1] |
                      efp[ 4][(l2>>22)  & 0x3f][1] |
                      efp[11][ r1       & 0x3f][1] |
                      efp[10][(r1>>6)   & 0x3f][1] |
                      efp[ 9][(r1>>16)  & 0x3f][1] |
                      efp[ 8][(r1>>22)  & 0x3f][1] |
                      efp[15][ r2       & 0x3f][1] |
                      efp[14][(r2>>6)   & 0x3f][1] |
                      efp[13][(r2>>16)  & 0x3f][1] |
                      efp[12][(r2>>22)  & 0x3f][1];

                if (salt[12]==( (v2 & 0xf) << 2 )) {
                        v2 = (v2>>2) | ((v1 & 0x3)<<30);
                        if( (salt[ 7]==((v2>>26) & 0x3f)) &&
                            (salt[ 8]==((v2>>20) & 0x3f)) &&
                            (salt[ 9]==((v2>>14) & 0x3f)) &&
                            (salt[10]==((v2>> 8) & 0x3f)) &&
                            (salt[11]==((v2>> 2) & 0x3f))
                            ) return(1);
                }
    }
    return(0);
  }
